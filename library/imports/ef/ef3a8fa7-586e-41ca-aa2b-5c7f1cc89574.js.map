{"version":3,"sources":["../../../../../assets/Script/lib/assets/Script/lib/GameState.js"],"names":["AdMob","require","exports","name","isFBInstantGame","window","FBInstant","iswechatgame","wx","istoutiaogame","tt","currentLevel","playingLevel","newtable","anims","clubstime","clubsget","club","now_ball_in_hole","EventEmitter","events","options","sound","music","platform","levelRank","levels","init","cc","sys","localStorage","getItem","JSON","parse","clubs","nt","cl","lr","user","userData","GooglePay","undefined","firstPlay","openId","newbieGuild","Promise","resolve","saveUserData","setItem","stringify","getFBInterstitial","console","log","fbInterstitial","getInterstitialAdAsync","then","interstitial","loadAsync","catch","err","showFBInterstitial","showAsync","error","initFBVideo","fbVideo","video","FaceBookEventValue","getFBVideo","JavaCallBack","showFBVideo","_t","Date","now","setT","logT","label","shootBallConfig","angle","distance","power"],"mappings":"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","file":"GameState.js","sourceRoot":"../../../../../assets/Script/lib","sourcesContent":["'use strict';\nconst AdMob = require('AdMob');\nexports.name = 'GameState';\n\nexports.isFBInstantGame = !!window.FBInstant;\nexports.iswechatgame = !!window.wx;\nexports.istoutiaogame = !!window.tt;\nexports.currentLevel = 1;\nexports.playingLevel = 0;\nexports.newtable = 0;\nexports.anims = 0;\nexports.clubstime=[0,0,0,0,0,0,0,0];\nexports.clubsget=[10,10,8,8,5,5,0,0];\nexports.club = 7;\n\nexports.now_ball_in_hole = null;\n// exports.ownlist = []; \n// exports.othlist = [];\n// exports.PanchromaticBall = [1,2,3,4,5,6,7];//全色球\n// exports.ColorBall = [9,10,11,12,13,14,15];//花色球\n\n\nlet EventEmitter = require(\"events\").EventEmitter;\nexports.events = new EventEmitter();\n\nexports.options = {\n  sound: 'on',\n  music: 'on',\n};\n\nexports.platform = 'android google' //xiaomi;  android google\nexports.levelRank = [ null ];\n\nexports.levels = require('levels');\n\nexports.init = function() {\n  let club = cc.sys.localStorage.getItem('club');\n  if (club) {\n    this.club = JSON.parse(club);\n  } else {\n    this.club = 7;\n  }\n  let clubs = cc.sys.localStorage.getItem('clubs');\n  if (clubs) {\n    this.clubstime = JSON.parse(clubs);\n  } else {\n    this.clubstime = [0,0,0,0,0,0,0,0];\n  }\n  let nt = cc.sys.localStorage.getItem('newtable');\n  if (nt) {\n    this.newtable = JSON.parse(nt);\n  } else {\n    this.newtable = 0;\n  }\n  let cl = cc.sys.localStorage.getItem('currentLevel');\n  if (cl) {\n    this.currentLevel = JSON.parse(cl);\n  } else {\n    this.currentLevel = 1;\n  }\n  // this.currentLevel = 16;\n  let lr = cc.sys.localStorage.getItem('levelRank');\n  if (lr) {\n    this.levelRank = JSON.parse(lr);\n  } else {\n    this.levelRank = [];\n  }\n\n  let user = cc.sys.localStorage.getItem('userData');\n  if(user) {\n    exports.userData = JSON.parse(user)\n\n    if(this.userData.GooglePay === undefined){\n      this.userData.GooglePay = false\n    }\n\n    if(this.userData.firstPlay === undefined){\n      this.userData.firstPlay = true\n    }\n\n    // if(this.userData.newbieGuild === undefined){ \n      // this.userData.newbieGuild = true\n    // }\n    \n    // console.log(this.userData)\n  }else{\n    exports.userData = {\n      name:'',\n      openId:'',\n      GooglePay : false,\n      firstPlay: true,\n      newbieGuild: true,\n    }\n  }\n\n  return Promise.resolve();\n};\nexports.saveUserData = function(){\n  cc.sys.localStorage.setItem('userData', JSON.stringify(this.userData));\n};\nexports.getFBInterstitial = function() {\n  console.log('getFBInterstitial-----')\n  if (!this.fbInterstitial){\n    FBInstant.getInterstitialAdAsync('298471817559434_298473940892555')\n    .then(interstitial => {\n      this.fbInterstitial = interstitial;\n      return interstitial.loadAsync();\n    })\n    .catch(err => {\n      // ignore error\n      console.log(`ERROR: ${JSON.stringify(err)}`);\n    })\n  }else{\n    this.fbInterstitial.loadAsync()\n    .then(()=>{\n      console.log('插屏加载成功')\n    })\n  }\n  \n};\n\nexports.showFBInterstitial = function() {\n   console.log('showFBInterstitial-----')\n  if (this.fbInterstitial) {\n    let interstitial = this.fbInterstitial;\n\n    this.getFBInterstitial();\n\n    return interstitial.showAsync()\n    .then(()=>{\n\n    })\n    .catch(err => {\n      // ignore error\n      console.error(`log: ${JSON.stringify(err)}`);\n    });\n  } else {\n    this.getFBInterstitial()\n    return Promise.resolve();\n  }\n};\n\nexports.initFBVideo = function() {\n  console.log('initFBVideo-----')\n  FBInstant.getInterstitialAdAsync('298471817559434_333738157366133')\n  .then(video => {\n    this.fbVideo = video;\n    \n    return video.loadAsync()\n    .then(()=> {\n      AdMob.FaceBookEventValue('initFBVideo');\n      // JavaCallBack('onRewardedVideoAdLoaded')\n      // this.showFBVideo()\n    });\n  })\n  .catch(err => {\n    // this.getFBVideo();\n    // ignore error\n    console.log(`ERROR: ${JSON.stringify(err)}`);\n  })\n};\nexports.getFBVideo = function() {\n  console.log('getFBVideo2-----')\n  this.fbVideo.loadAsync()\n  .then(()=> {\n      JavaCallBack('onRewardedVideoAdLoaded')\n      AdMob.FaceBookEventValue('getFBVideo');\n      this.showFBVideo()\n  })\n  .catch(err => {\n    JavaCallBack('noAds')\n    // this.getFBVideo();\n    // ignore error\n    console.log(`ERROR: ${JSON.stringify(err)}`);\n  })\n};\n\nexports.showFBVideo = function() {\n  console.log('showFBVideo-----')\n  if (this.fbVideo) {\n    let video = this.fbVideo;\n    // this.fbVideo = null;\n   \n\n    return video.showAsync()\n    .then(()=>{\n      JavaCallBack('onRewarded')\n      AdMob.FaceBookEventValue('onRewarded');\n    })\n    .catch(err => {\n      JavaCallBack('noAds')\n      // ignore error\n      console.log(`ERROR: ${JSON.stringify(err)}`);\n    });\n  } else {\n    \n    return Promise.resolve();\n  }\n};\n\nexports._t = Date.now();\n\nexports.setT = function() {\n  exports._t = Date.now();\n};\n\nexports.logT = function(label) {\n  label = label || '';\n  if (label) {\n    console.log(`T (${label}):`, Date.now() - this._t);\n  } else {\n    console.log(`T:`, Date.now() - this._t);\n  }\n  this.setT();\n};\n\n\nexports.shootBallConfig = {\n  angle:0,\n  distance:0,\n  power:0,\n}\n"]}